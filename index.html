<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>MADA · Portabilidad</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f9;
      margin: 0; padding: 0;
    }
    header {
      background: #003b8f; color: #fff;
      padding: 15px; text-align: center;
    }
    main {
      max-width: 800px; margin: 20px auto;
      background: #fff; padding: 20px;
      border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    label { display:block; margin:10px 0 5px; }
    input, select {
      width:100%; padding:8px; border:1px solid #ccc; border-radius:4px;
    }
    button {
      margin-top:15px; padding:10px 15px;
      background:#003b8f; color:#fff; border:none; border-radius:4px;
      cursor:pointer;
    }
    button:hover { background:#0056d6; }
    .status { margin-top:15px; padding:10px; border-radius:4px; }
    .ok { background:#e0f7e9; color:#0a7c39; }
    .error { background:#fdecea; color:#b00020; }
  </style>
</head>
<body>
  <header>
    <h1>MADA · Portabilidad</h1>
  </header>
  <main>
    <form id="captureForm">
      <label>Plaza</label>
      <select id="plaza" required>
        <option value="">-- Selecciona plaza --</option>
        <option>MONTERREY</option>
        <option>MANTE</option>
        <option>REYNOSA</option>
        <option>MATAMOROS</option>
        <option>SALTILLO</option>
        <option>CHIHUAHUA</option>
        <option>DELICIAS</option>
        <option>CUAHUTEMOC</option>
        <option>TAMPICO</option>
      </select>

      <label>Número</label>
      <input type="text" id="telefono" maxlength="10" required>

      <label>Nombre completo</label>
      <input type="text" id="nombreCompleto" required>

      <label>Fecha de nacimiento</label>
      <input type="date" id="fechaNacimiento">

      <label>Estado de nacimiento</label>
      <input type="text" id="estadoNacimiento">

      <label>CURP</label>
      <input type="text" id="curp" maxlength="18">

      <label>ICC</label>
      <input type="text" id="icc">

      <label>NIP</label>
      <input type="text" id="nip" maxlength="4">

      <label>Carrier</label>
      <input type="text" id="carrier">

      <label>Promotor</label>
      <input type="text" id="promotor">

      <button type="submit">Crear ficha</button>
    </form>

    <div id="status" class="status"></div>
  </main>

  <script>
    // ✅ URL googleusercontent de tu Apps Script
    const SHEETS_WEBAPP_URL =
      "https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLhsvzpTaojWuVDHMj2lcWdoIdzvme27yjYY3AevM-H8I5iWk537SuJ0iYIpqD1Jm_9wH5Uz04FSpDDgLGTuT5r2msGwA0YXIiGPTvR7a6Tq1N5VkVPRiVlRm517Pf5yX5O6pHxUrOWu-LKYqo8-7mwM8X0zdcdjSs6-ugs06ZtQfrlCje3jpNcOKOvohjz9zaJOVolYQvA9fqx2JEPqiSasgRDDSDOWjMffz3yvg0nLyVkAkOhN6en00bn0fDJCT1PpFmcrcpwWa21Kgbpj2Fn-edVs4vMB310XV9W8&lib=MxWPO1SpThVqWmX_6hVFVa-LeN5GWFN6y";

    const form = document.getElementById("captureForm");
    const statusDiv = document.getElementById("status");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const data = {
        type: "capture",
        plaza: document.getElementById("plaza").value,
        telefono: document.getElementById("telefono").value,
        nombreCompleto: document.getElementById("nombreCompleto").value,
        fechaNacimiento: document.getElementById("fechaNacimiento").value,
        estadoNacimiento: document.getElementById("estadoNacimiento").value,
        curp: document.getElementById("curp").value,
        icc: document.getElementById("icc").value,
        nip: document.getElementById("nip").value,
        carrier: document.getElementById("carrier").value,
        promotor: document.getElementById("promotor").value,
      };

      try {
        const res = await fetch(SHEETS_WEBAPP_URL, {
          method: "POST",
          body: JSON.stringify(data),
          headers: { "Content-Type": "application/json" },
        });
        const json = await res.json();
        if (json.ok) {
          statusDiv.textContent = "✅ Ficha guardada en hoja: " + json.sheet;
          statusDiv.className = "status ok";
          form.reset();
        } else {
          throw new Error(json.error || "Error desconocido");
        }
      } catch (err) {
        statusDiv.textContent = "❌ Error: " + err.message;
        statusDiv.className = "status error";
      }
    });
  </script>
</body>
</html>
